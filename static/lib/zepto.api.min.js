window.API=function(){var that=this;function processCallback(t,a){var e=getSetting(t);if(e)return e(a)}function getSetting(t){var a=window.API.setting;return!!a[t]&&a[t]}function buildUrl(t){var a=getSetting("url");return a="function"==typeof a?a(t):a.replace(/\%api\%/gi,t)}return that.post=function(api,post,callback){$.post(buildUrl(api),post,function(result,textStatus,request){var data;try{data=eval("("+$.trim(result.replace(/(^<html>\s*?<body>)|(<\/body>\s*?<\/html>\s*$)/gi,""))+")")}catch(t){console.log(result)}data||(data={error:1,data:"操作失败，请重试",extend:!1}),processCallback("beforeCallback",data),callback&&callback(data)||processCallback("callback",data)})},that.get=function(api,callback){$.get(buildUrl(api),function(result,textStatus,request){var data;if(-1==request.getResponseHeader("Content-Type").search(/json/gi))try{data=eval("("+result+")")}catch(t){console.log(result)}else data=result;data||(data={error:1,data:"操作失败，请重试",extend:!1}),callback&&callback(data)||processCallback("callback",data)})},that.setting={callback:!1,url:!1},that}();